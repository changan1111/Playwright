import SSH2Promise from 'ssh2-promise';
import fs from 'fs';

export class SSHClient {
  async runCommands(host: string, username: string, privateKeyPath: string, commands: string[]) {
    const ssh = new SSH2Promise({
      host: host,
      username: username,
      identity: fs.readFileSync(privateKeyPath, 'utf-8'), // Load private key
    });

    try {
      await ssh.connect();
      console.log('Connected to the server.');

      for (const command of commands) {
        console.log(`Running: ${command}`);
        const result = await ssh.exec(command);
        console.log(`Output:\n${result}`);
      }
    } catch (error) {
      console.error('Error executing commands:', error);
    } finally {
      await ssh.close();
      console.log('Disconnected from the server.');
    }
  }
}

// Example usage:
const sshClient = new SSHClient();
const commands = ['command1', 'command2', 'command3', 'command4', 'command5', 'command6'];

sshClient.runCommands('your.remote.server', 'your-username', '/path/to/id_rsa', commands);
